# Twello AI Agent

This project is an AI-powered voice assistant that integrates OpenAI Chat Completions API, ElevenLabs for Text-to-Speech (TTS), and Twilio for telephony. It also includes email functionality using Nodemailer.

## Prerequisites

- [Node.js](https://nodejs.org/) (v18 or higher recommended)
- [ngrok](https://ngrok.com/) (for local development)
- A Twilio Account
- An ElevenLabs Account
- An OpenAI Account

## Installation

1.  Clone the repository:
    ```bash
    git clone <repository-url>
    cd Twello
    ```

2.  Install dependencies:
    ```bash
    npm install
    ```

3.  Set up environment variables:
    ```bash
    cp .env.example .env
    ```
    Open `.env` and fill in the required values (see below for details).

## Configuration Guide

### 1. ElevenLabs Setup

ElevenLabs provides the realistic voice for the AI agent.

1.  **Sign up/Login**: Go to [ElevenLabs](https://elevenlabs.io/) and create an account.
2.  **Get API Key**:
    *   Click on your profile icon in the top right.
    *   Select **Profile + API key**.
    *   Click the "eye" icon to reveal your API Key.
    *   Copy this key and paste it into `.env` as `ELEVENLABS_API_KEY`.
3.  **Get Voice ID**:
    *   Go to **Voices** or **VoiceLab**.
    *   Select a voice you want to use.
    *   Click the "ID" label (usually looks like a copy icon next to the voice ID) to copy the Voice ID.
    *   Paste this ID into `.env` as `ELEVENLABS_VOICE_ID`.

### 2. Twilio Setup

Twilio handles the incoming and outgoing phone calls.

1.  **Sign up/Login**: Go to [Twilio](https://www.twilio.com/) and create an account.
2.  **Get Credentials**:
    *   On the **Console Dashboard**, find your **Account SID** and **Auth Token**.
    *   Copy these values into `.env` as `TWILIO_ACCOUNT_SID` and `TWILIO_AUTH_TOKEN`.
3.  **Buy a Phone Number**:
    *   Go to **Phone Numbers** > **Manage** > **Buy a number**.
    *   Purchase a number with "Voice" capabilities.
4.  **Configure Webhook (Local Development)**:
    *   To test locally, you need to expose your local server to the internet. Use `ngrok`:
        ```bash
        ngrok http 3000
        ```
    *   Copy the HTTPS URL generated by ngrok (e.g., `https://your-ngrok-id.ngrok-free.app`).
    *   Go to your Twilio Phone Number settings (**Phone Numbers** > **Manage** > **Active numbers** > click your number).
    *   Scroll down to the **Voice & Fax** section.
    *   Under **A CALL COMES IN**, set the dropdown to **Webhook**.
    *   Paste your ngrok URL with the `/incoming` endpoint:
        ```
        https://your-ngrok-id.ngrok-free.app/incoming
        ```
    *   Ensure the HTTP method is set to **POST** or **HTTP POST**.
    *   Click **Save**.
5.  **Configure SMS Webhook**:
    *   In the same **Voice & Fax** section (or **Messaging** section if separate), find **A MESSAGE COMES IN**.
    *   Set the dropdown to **Webhook**.
    *   Paste your ngrok URL with the `/incoming-sms` endpoint:
        ```
        https://your-ngrok-id.ngrok-free.app/incoming-sms
        ```
    *   Ensure the HTTP method is set to **POST**.
    *   Click **Save**.

### 3. OpenAI Setup

1.  **Get API Key**: Go to [OpenAI Platform](https://platform.openai.com/api-keys) and generate a new secret key.
2.  Add it to `.env` as `OPENAI_API_KEY`.

### 4. Email Setup (Optional)

If you want the agent to send meeting request emails:

1.  Configure your SMTP server details in `.env` (`SMTP_HOST`, `SMTP_PORT`, `SMTP_USER`, `SMTP_PASS`, `EMAIL_TO`).
2.  For Gmail, you might need to use an "App Password" if 2FA is enabled.

## Running the Server

1.  Start the server:
    ```bash
    node index.js
    ```
    Or if you have scripts set up:
    ```bash
    npm start
    ```

2.  Ensure `ngrok` is running (if developing locally).
3.  Call your Twilio phone number. The AI agent should answer!

## Troubleshooting

-   **No Audio**: Check your ElevenLabs quota and API key. Ensure `OPENAI_API_KEY` is valid.
-   **Twilio Error**: Check the Twilio Debugger in the Console for webhook errors.
-   **Connection Refused**: Ensure your local server is running and the ngrok URL in Twilio matches your current ngrok session.
